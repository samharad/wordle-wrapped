#!/bin/bash

# Set the URL to fetch Wordle history
URL="https://screenrant.com/wordle-history/"

# Create a temporary file to store the HTML content
TEMP_HTML=$(mktemp /tmp/wordle_history_XXXXXX.html)

# Fetch the website content
echo "Fetching website content..."
curl -s "$URL" -o "$TEMP_HTML"

# Check if curl was successful
if [[ $? -ne 0 ]]; then
    echo "Failed to fetch the webpage. Exiting..."
    exit 1
fi

echo "Website content downloaded to $TEMP_HTML"

# Extract Wordle data using pup
# Example extraction: Look for elements that typically contain the Wordle answers in a table or list
echo "Extracting Wordle answers..."
pup 'table td text{}' < "$TEMP_HTML" > extracted_data.txt

OUT=wordle_answers_cleaned.txt

# Post-process the extracted data (if necessary)
echo "Post-processing extracted data..."
awk 'NR%3==1 {date=$0} NR%3==2 {puzzle=$0} NR%3==0 {answer=$0; print date, puzzle, answer}' extracted_data.txt > $OUT

sed -i '' '/^[[:space:]]*$/d' $OUT
sed -i '' 's/^[[:space:]]\+//; s/[[:space:]]\+$//' $OUT

echo "Cleaned Wordle answers saved to $OUT"

# Cleanup
rm "$TEMP_HTML" extracted_data.txt

echo "Temporary files cleaned up. Done!"
